(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9655005a"],{"6b27":function(e,t,a){"use strict";var r=a("a9a9"),s=a.n(r);s.a},7101:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-bg"},[a("el-tabs",{attrs:{stretch:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"管理员登录",name:"teacher"}},[a("LoginSelect",{attrs:{loginAuth:"teacher"}})],1),a("el-tab-pane",{attrs:{label:"学生登录",name:"student"}},[a("LoginSelect",{attrs:{loginAuth:"student"}})],1)],1)],1)},s=[],n=a("d225"),i=a("b0b4"),o=a("308d"),c=a("6bb5"),u=a("4e2b"),l=a("9ab4"),h=a("60a3"),d=a("73ec"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"status-icon":""}},[a("el-form-item",{attrs:{prop:"userName"}},[a("el-input",{staticClass:"input",attrs:{placeholder:/^teacher$/.test(e.auth)||this.isPhone?"请输入11位手机号码":"请输入8位学号",maxlength:"11",clearable:""},model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"el-icon-user"})])],2)],1),e.isPhone?a("el-form-item",{attrs:{prop:"authCode"}},[a("el-row",[a("el-col",{attrs:{span:17}},[a("el-input",{staticClass:"input",attrs:{maxlength:"6",placeholder:"请输入6位数字验证码",clearable:""},model:{value:e.ruleForm.authCode,callback:function(t){e.$set(e.ruleForm,"authCode",t)},expression:"ruleForm.authCode"}})],1),a("el-col",{attrs:{span:7}},[a("el-button",{staticClass:"input",attrs:{type:"primary"},on:{click:e.loginWithCode}},[e._v("\n\t\t\t\t\t\t获取验证码\n\t\t\t\t\t")])],1)],1)],1):a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{staticClass:"input",attrs:{clearable:"",placeholder:"密码","show-password":""},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"el-icon-lock"})])],2)],1),a("div",{staticClass:"other-login input"},[a("el-link",[e._v("忘记密码?")]),a("el-link",{on:{click:e.change}},[e._v(e._s(e.isPhone?"密码登录":"手机验证码登录"))])],1)],1),a("el-button",{staticClass:"input",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1)},p=[],b=(a("a481"),a("96cf"),a("3b8d")),v=a("1035"),f=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.loginAuth="teacher",e.code="",e.ruleForm={userName:"",password:"",authCode:""},e.rules={userName:[{validator:e.validateUserName,trigger:"blur"}],password:[{validator:e.validatePassword,trigger:"blur"}],authCode:[{validator:e.validateAuthCode,trigger:"blur"}]},e.isPhone=!1,e.activeName="teacher",e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"submitForm",value:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.login()}))}},{key:"validateUserName",value:function(e,t,a){var r="teacher"===this.auth||this.isPhone?/^1[3-9]\d{9}$/:/^\d{8}$/,s="teacher"===this.auth||this.isPhone?"手机号码":"学号";r.test(t)||a(new Error("请输入正确格式的"+s)),a()}},{key:"validatePassword",value:function(e,t,a){(t.length<6||t.length>20)&&a(new Error("格式错误，请输入长度为6~20位密码")),a()}},{key:"validateAuthCode",value:function(e,t,a){/^\d{6}$/.test(t)||a(new Error("请输入6为数字验证码")),a()}},{key:"change",value:function(){this.isPhone=!this.isPhone}},{key:"login",value:function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={code:"",data:[],msg:""},!this.isPhone){e.next=13;break}if(a={phone:this.ruleForm.userName,code:this.ruleForm.authCode},"teacher"!==this.auth){e.next=9;break}return e.next=6,Object(v["w"])(a);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,Object(v["A"])(a);case 11:e.t0=e.sent;case 12:t=e.t0;case 13:if("teacher"!==this.auth||this.isPhone){e.next=17;break}return e.next=16,Object(v["t"])({username:this.ruleForm.userName,password:this.ruleForm.password});case 16:t=e.sent;case 17:if("student"!==this.auth||this.isPhone){e.next=21;break}return e.next=20,Object(v["r"])({uId:this.ruleForm.userName,password:this.ruleForm.password});case 20:t=e.sent;case 21:console.log("res: ",t),1===parseInt(t.code,10)?(localStorage.setItem("as_token",t.data[0].token),2===t.data.length&&(sessionStorage.setItem("uId",t.data[1].uId),sessionStorage.setItem("name",t.data[1].username)),localStorage.setItem("auth",this.auth),this.$router.replace("/".concat(this.auth))):this.$message.error(t.msg);case 23:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loginWithCode",value:function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={data:[],code:"",msg:""},a={phone:this.ruleForm.userName},"teacher"!==this.auth){e.next=6;break}return e.next=5,Object(v["s"])(a);case 5:t=e.sent;case 6:if("student"!==this.auth){e.next=10;break}return e.next=9,Object(v["B"])(a);case 9:t=e.sent;case 10:1===parseInt(t.code,10)?this.$message.success(t.msg):this.$message.error(t.msg);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"auth",get:function(){return this.loginAuth}}]),t}(h["c"]);Object(l["a"])([Object(h["b"])({required:!0,validator:function(e){return-1!==["teacher","student"].indexOf(e)}})],f.prototype,"loginAuth",void 0),f=Object(l["a"])([h["a"]],f);var g=f,k=g,w=(a("d748"),a("2877")),O=Object(w["a"])(k,m,p,!1,null,"29c50746",null),j=O.exports,x=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.activeName="teacher",e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"created",value:function(){Object(d["c"])("登录")}}]),t}(h["c"]);x=Object(l["a"])([Object(h["a"])({components:{LoginSelect:j}})],x);var F=x,C=F,y=(a("6b27"),Object(w["a"])(C,r,s,!1,null,"04ac340c",null));t["default"]=y.exports},a9a9:function(e,t,a){},ba67:function(e,t,a){},d748:function(e,t,a){"use strict";var r=a("ba67"),s=a.n(r);s.a}}]);
//# sourceMappingURL=chunk-9655005a.61462918.js.map